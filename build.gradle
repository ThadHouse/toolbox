import dev.gradleplugins.GitHubSourceControlManagerExtension
import dev.gradleplugins.GitHubSourceControlManagerPlugin
import dev.gradleplugins.OpenSourceSoftwareLicensePlugin

// WORKAROUND: There seems to be a bug where Gradle is too eager to perform dependency substitution.
// It replace the binary dependency for the project within the current multi-project.
// The result is a dependency cycle with an error message wrongly pointing to miss built plugin project.
buildscript {
    repositories {
        maven { url = 'https://dl.bintray.com/gradle-plugins/distributions' }
    }
    dependencies {
        classpath 'dev.gradleplugins:gradle-plugin-development:0.0.28'
    }
}

plugins {
    id 'dev.gradleplugins.experimental.setup'
}

allprojects {
    version = rootProject.file('version.txt').text
    group = 'dev.gradleplugins'

    apply plugin: GitHubSourceControlManagerPlugin
    extensions.configure(GitHubSourceControlManagerExtension) {
        it.gitHubOrganization.set('gradle-plugins')
    }

    apply plugin: OpenSourceSoftwareLicensePlugin
}

//// TODO: Fails the build if running with anything else than Java 8 (or fix the projects so we can execute the build on other Java version)
//dependencies {
//    implementation(kotlinModule("stdlib", kotlin_version))
//}
//repositories {
//    mavenCentral()
//}